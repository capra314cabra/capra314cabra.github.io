<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="capra314cabra"><meta name=description content="簡単な計算をする時にPythonを使っていませんか?対話形式で実行するのはとても便利ですよね。しかし、これと同じことはC#でも出来るのです。"><meta name=keywords content="C#,tips,today,対話形式,動的実行"><meta name=twitter:card content="summary"><meta name=twitter:title content="[Today's C# tips] #3 C#を対話形式で実行しよう"><meta name=twitter:description content="簡単な計算をする時にPythonを使っていませんか?対話形式で実行するのはとても便利ですよね。しかし、これと同じことはC#でも出来るのです。"><meta property="og:title" content="[Today's C# tips] #3 C#を対話形式で実行しよう"><meta property="og:description" content="簡単な計算をする時にPythonを使っていませんか?対話形式で実行するのはとても便利ですよね。しかし、これと同じことはC#でも出来るのです。"><meta property="og:type" content="article"><meta property="og:url" content="https://capra314cabra.github.io/posts/2020-05-24-csharptips3/"><meta property="article:published_time" content="2020-05-24T06:36:13+09:00"><meta property="article:modified_time" content="2020-05-24T11:19:42+09:00"><meta property="og:site_name" content="Capra Cabra Notes"><base href=https://capra314cabra.github.io/posts/2020-05-24-csharptips3/><title>[Today's C# tips] #3 C#を対話形式で実行しよう · Capra Cabra Notes</title><link rel=canonical href=https://capra314cabra.github.io/posts/2020-05-24-csharptips3/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js onload=hljs.initHighlightingOnLoad(); async></script><link rel=stylesheet href=https://capra314cabra.github.io/css/coder.min.0f28f86059ff6e679f9cf08b95a190db2c1071167c8abc38584f0eef978c93f7.css integrity="sha256-Dyj4YFn/bmefnPCLlaGQ2ywQcRZ8irw4WE8O75eMk/c=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/vs2015.min.css><script src=https://cdn.jsdelivr.net/npm/gist-embed@1.0.3/dist/gist-embed.min.js async></script><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js async></script><link rel=icon type=image/png href=https://capra314cabra.github.io/images/logo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://capra314cabra.github.io/images/logo/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.75.1"><style type=text/css>.icon{font-size:2.5em}</style></head><body class=colorscheme-light><script type=text/javascript src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e930c5ad359121c" async></script><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://capra314cabra.github.io/>Capra Cabra Notes</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fas fa-bars"></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://capra314cabra.github.io/>About</a></li><li class=navigation-item><a class=navigation-link href=https://capra314cabra.github.io/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://capra314cabra.github.io/games/>Games</a></li><li class=navigation-item><a class=navigation-link href=https://capra314cabra.github.io/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/capra314cabra>GitHub</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=https://capra314cabra.github.io/en/>English</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>[Today's C# tips] #3 C#を対話形式で実行しよう</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i><time datetime=2020-05-24T06:36:13+09:00>May 24, 2020</time></span>
<span class=reading-time><i class="fas fa-clock"></i>1分で読めます</span></div><div class=tags><i class="fas fa-tag"></i><a href=https://capra314cabra.github.io/tags/csharp/>CSharp</a></div></div></header><div><p>簡単な計算をする時にPythonを使っていませんか?<br>対話形式で実行するのはとても便利ですよね。しかし、これと同じことはC#でも出来るのです。</p><h2 id=そもそも対話形式とは>そもそも対話形式とは?</h2><p>ユーザーがプログラムを入力すると、それを評価してくれるのが対話形式です。<br>Pythonを使ったことがあれば、以下のような感じです。</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>&gt;&gt;&gt; a = <span style=color:#ff0;font-weight:700>10</span>
&gt;&gt;&gt; a * a * <span style=color:#ff0;font-weight:700>3.14</span>
<span style=color:#ff0;font-weight:700>314.0</span>
</code></pre></div><p>その場で計算してくれるので、書き捨てコードとしてとても有用です。(筆者は素数判定とかを無性にしたくなった時に使っています。)</p><h2 id=cって静的言語だから無理なんじゃないですか>C#って静的言語だから無理なんじゃないですか?</h2><p>Pythonは動的実行をしている(実行時に型変換等を行っている)のに対して、<br>C#はC++などと同じで静的言語であるので実行にはコンパイルが不可欠なはずです。<br>コンパイルが必要ということは、時間がかかりすぎるので対話形式で実行するのには致命的&mldr;</p><p><a href=https://ja.wikipedia.org/wiki/%E5%8B%95%E7%9A%84%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E8%A8%80%E8%AA%9E>Wikipedia 動的プログラミング言語</a></p><p>しかし、C#を動的に実行したいと考える人はいるようで</p><h2 id=cを対話形式で実行する拡張>C#を対話形式で実行する拡張</h2><p>世の中にはC#を対話形式で実行したいと思う人が少なからずいるのでしょう。C#を標準で対話形式で実行することは出来ませんが、
拡張を使用することでできるようになります。<br>いくつか拡張が存在するのでご紹介します。</p><h3 id=c-repl>C# REPL</h3><p>有名な対話形式の拡張として、オープンソースのC#の先駆けとなったMonoプロジェクトが提供する
<a href=https://www.mono-project.com/docs/tools+libraries/tools/repl/>C# REPL</a>があります。</p><p>使い方は簡単です。Monoをインストールして</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ csharp
</code></pre></div><p>と実行するだけです。<br>以下の様にC#を対話形式で実行することが可能です。</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ csharp
csharp&gt; using System;
csharp&gt; var a = 10;
csharp&gt; a * a * Math.PI;
314.159265358979
</code></pre></div><p>Mono C#を使用している方は今すぐ試すことができます。</p><h3 id=dotnet-script>dotnet script</h3><p>C# REPLはMonoプロジェクトのものでした。一方でこちらは .NET Coreで使うことができるものです。<br><a href=https://github.com/filipw/dotnet-script>dotnet script</a>は .NET CoreにGlobal toolとして以下のコマンドを使用してインストール出来ます。<br>.NET Core 2.1以上が必要なことに注意してください。</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ dotnet tool install -g dotnet-script
</code></pre></div><p>インストールした後は、<code>dotnet script</code>コマンドで対話形式で実行できます。</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>$ dotnet script
&gt; var a = 10;
&gt; a * a * Math.PI
314.1592653589793
</code></pre></div><p>また、dotnet scriptでは拡張子<code>csx</code>として作ったC#ファイルを動的実行することが可能であり、<br>しかもnugetを使用するための<code>#r</code>コマンド等が独自に定義されているのでとても便利です。</p><h3 id=dotnet-interactive>dotnet interactive</h3><p>これは公式が出した対話形式実行のための拡張です。<br><a href=https://github.com/dotnet/interactive>dotnet interactive</a></p><p>この拡張を使用すれば、PythonユーザーにはおなじみであろうJupyter notebookでC#を動かせるようになります。</p><p>以下のコマンドを使用してインストールすることができます。</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ dotnet tool install -g Microsoft.dotnet-interactive
$ dotnet interactive jupyter install
</code></pre></div><p>Jupyter notebookを開くとつい体が勝手に動いてPythonのコードを打ち込もうとすると思いますが、
一旦抑制してC#を書いてみてください。ちゃんと動きます。</p><h2 id=まとめ>まとめ</h2><p>いちいちC#のproject fileを作ってから書き捨てコードを書いている人は、今すぐinteractiveなC#に乗り換えましょう!<br><del>普通はPythonですが</del></p></div><footer><section class=see-also><h3>See also in Todays CSharp tips</h3><nav><ul><li><a href=https://capra314cabra.github.io/posts/2020-04-10-csharptips2/>[Today's C# tips] #2 privateなメンバーにアクセスしよう</a></li><li><a href=https://capra314cabra.github.io/posts/2020-03-20-onepoint-csharp/>[Today's C# tips] #1 C#でSQLみたいな構文?</a></li></ul></nav></section><script src=https://utteranc.es/client.js repo=capra314cabra/capra314cabra.github.io issue-term=title label=comments theme=github-light crossorigin=anonymous async></script></footer></article></section></div><footer class=footer><section class=container><p>Wanna be a developer improving our lives.</p>© 2020
<a href=https://github.com/capra314cabra>capra314cabra</a></section></footer></main></body></html>