<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="capra314cabra"><meta name=description content="HackIM 2020のWrite upです。解けている問題があまりにも少ないのは、気にしないで下さい..."><meta name=keywords content="CTF,Nullcon,HackIM,2020,Zelda"><meta name=twitter:card content="summary"><meta name=twitter:title content="[CTF Writeup]HackIM 2020のWrite up"><meta name=twitter:description content="HackIM 2020のWrite upです。解けている問題があまりにも少ないのは、気にしないで下さい..."><meta property="og:title" content="[CTF Writeup]HackIM 2020のWrite up"><meta property="og:description" content="HackIM 2020のWrite upです。解けている問題があまりにも少ないのは、気にしないで下さい..."><meta property="og:type" content="article"><meta property="og:url" content="https://capra314cabra.github.io/posts/hackim2020-writeup/"><meta property="article:published_time" content="2020-02-09T17:54:45+09:00"><meta property="article:modified_time" content="2020-03-09T12:32:51+09:00"><meta property="og:site_name" content="Capra Cabra Notes"><base href=https://capra314cabra.github.io/posts/hackim2020-writeup/><title>[CTF Writeup]HackIM 2020のWrite up · Capra Cabra Notes</title><link rel=canonical href=https://capra314cabra.github.io/posts/hackim2020-writeup/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js onload=hljs.initHighlightingOnLoad(); async></script><link rel=stylesheet href=https://capra314cabra.github.io/css/coder.min.0f28f86059ff6e679f9cf08b95a190db2c1071167c8abc38584f0eef978c93f7.css integrity="sha256-Dyj4YFn/bmefnPCLlaGQ2ywQcRZ8irw4WE8O75eMk/c=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/vs2015.min.css><script src=https://cdn.jsdelivr.net/npm/gist-embed@1.0.3/dist/gist-embed.min.js async></script><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js async></script><link rel=icon type=image/png href=https://capra314cabra.github.io/images/logo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://capra314cabra.github.io/images/logo/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.75.1"><style type=text/css>.icon{font-size:2.5em}</style></head><body class=colorscheme-light><script type=text/javascript src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e930c5ad359121c" async></script><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://capra314cabra.github.io/>Capra Cabra Notes</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fas fa-bars"></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://capra314cabra.github.io/>About</a></li><li class=navigation-item><a class=navigation-link href=https://capra314cabra.github.io/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://capra314cabra.github.io/games/>Games</a></li><li class=navigation-item><a class=navigation-link href=https://capra314cabra.github.io/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/capra314cabra>GitHub</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=https://capra314cabra.github.io/en/>English</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>[CTF Writeup]HackIM 2020のWrite up</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i><time datetime=2020-02-09T17:54:45+09:00>February 9, 2020</time></span>
<span class=reading-time><i class="fas fa-clock"></i>1分で読めます</span></div><div class=tags><i class="fas fa-tag"></i><a href=https://capra314cabra.github.io/tags/ctf/>CTF</a></div></div></header><div><p>Nullcon HackIM 2020に出たのでそのWrite upでも書こうかなーと思った次第です。</p><p>結論から申し上げますと、解けた問題は<strong>1</strong>問です&mldr;(しかも、その問題はコピペするだけ)</p><p>ただ、そんなのではWrite upとして意味をなさないので、競技終了後も作業していました。<br>結局ZeldaAdventureの最初の1問を解くことができたのでそれをここに載せます。</p><h3 id=問題の見た目>問題の見た目</h3><p><img src=https://capra314cabra.github.io/images/hackim2020-game.jpg alt="Game scene" class=center width=500 height=300></p><p>Unity製のGameで、このNPC(白い敵)を1体以上倒すとFlagを手に入れられる、とあります。<br>Playerは剣と体当たり(接触)することでNPCにダメージを与えられますが、敵のHPがとても高く、現実的な時間に倒せないようになっています。</p><h3 id=やったこと>やったこと</h3><p>UnityのWindowsでビルドした時のファイル構成は決まっています。<br>特に、プログラマーが書いたコードは<code>AssemblyCSharp.dll</code>というファイルにコンパイルされて存在しています。</p><p>ここで、dnSpyを使用して<code>AssemblyCSharp.dll</code>の中のコードを読んでみます。<br>コードの森を探索していると&mldr;</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=color:#007f7f>// Token: 0x06000006 RID: 6
</span><span style=color:#007f7f></span><span style=color:#fff;font-weight:700>private</span> <span style=color:#fff;font-weight:700>void</span> TakeDamage(<span style=color:#fff;font-weight:700>float</span> damage)
{
    <span style=color:#fff;font-weight:700>this</span>.health -= damage;
    <span style=color:#fff;font-weight:700>if</span> (<span style=color:#fff;font-weight:700>this</span>.health &lt;= <span style=color:#ff0;font-weight:700>0f</span>)
    {
        <span style=color:#fff;font-weight:700>base</span>.StartCoroutine(<span style=color:#fff;font-weight:700>this</span>.ShowSome());
        <span style=color:#fff;font-weight:700>base</span>.gameObject.SetActive(<span style=color:#fff;font-weight:700>false</span>);
    }
}
</code></pre></div><p>ダメージを処理している部分を見つけました。<br>HPが0になると<code>ShowSome</code>というコールチンを回し始めるようです。</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=color:#007f7f>// Token: 0x0600000A RID: 10
</span><span style=color:#007f7f></span><span style=color:#fff;font-weight:700>private</span> IEnumerator ShowSome()
{
    <span style=color:#fff;font-weight:700>this</span>.textbox.SetActive(<span style=color:#fff;font-weight:700>true</span>);
    <span style=color:#fff;font-weight:700>yield</span> <span style=color:#fff;font-weight:700>return</span> <span style=color:#fff;font-weight:700>new</span> WaitForSeconds(<span style=color:#ff0;font-weight:700>3f</span>);
    <span style=color:#fff;font-weight:700>this</span>.textbox.SetActive(<span style=color:#fff;font-weight:700>false</span>);
    <span style=color:#fff;font-weight:700>yield</span> <span style=color:#fff;font-weight:700>return</span> <span style=color:#fff;font-weight:700>null</span>;
    <span style=color:#fff;font-weight:700>yield</span> <span style=color:#fff;font-weight:700>break</span>;
}
</code></pre></div><p><code>ShowSome</code>をみると<code>this.textbox</code>を見せるようにしているみたいです。<br>これはこのTextBoxがFlagを持っているのでしょう。<br>dnSpyは実はDLLを編集する事が出来るので、この<code>this.textbox</code>を最初から表示させるようにコードを書き換えれば、Flagゲットです。</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=font-weight:700>Flag</span>: REVOLUTIONSTARTSWITHME
</code></pre></div><p>フォントがおしゃれすぎて読みにくかったです(褒めてます)</p><h2 id=おわりに>おわりに</h2><p>HackIM 2020の前に無力さを感じたので、もっと勉強してから出直します&mldr;</p><h2 id=参考>参考</h2><p><a href=https://github.com/xcsh/Unity-game-hacking>Unity-Game-Hacking</a></p></div><footer><script src=https://utteranc.es/client.js repo=capra314cabra/capra314cabra.github.io issue-term=title label=comments theme=github-light crossorigin=anonymous async></script></footer></article></section></div><footer class=footer><section class=container><p>Wanna be a developer improving our lives.</p>© 2020
<a href=https://github.com/capra314cabra>capra314cabra</a></section></footer></main></body></html>